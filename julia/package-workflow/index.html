<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/marginalia/libs/katex/katex.min.css"> <link rel=stylesheet  href="/marginalia/libs/highlight/github.min.css"> <link rel=stylesheet  href="/marginalia/css/franklin.css"> <link rel=stylesheet  href="/marginalia/css/poole_lanyon.css"> <link rel=stylesheet  href="/marginalia/css/adjust.css"> <link rel=icon  href="/marginalia/assets/favicon.png"> <title>Julia: Package Workflow</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>Marginalia</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/marginalia/">Home</a> <a class="sidebar-nav-item " href="/marginalia/julia/">Julia</a> <a class="sidebar-nav-item " href="/marginalia/git/">Git</a> <a class="sidebar-nav-item " href="/marginalia/older-posts/">Older posts</a> </nav> <div class=sidebar-item > <p>&copy; Jürgen Fuhrmann.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/marginalia/" title=Home >Marginalia</a> </h3> </div> </div> </div> <div class="container content"> <div class=franklin-content ><h1 id=julia_package_workflow ><a href="#julia_package_workflow" class=header-anchor >Julia: Package Workflow</a></h1> <p>&#40;Draft, work in progress&#41;</p> <div class=franklin-toc ><ol><li><a href="#resources">Resources</a><li><a href="#starting_a_package">Starting a package</a><ol><li><a href="#where_do_packages_under_development_reside">Where do packages under development reside ?</a><li><a href="#starting_a_package_repository">Starting a package repository</a></ol><li><a href="#tests">Tests</a><li><a href="#documentation">Documentation</a><ol><li><a href="#generation_using_a_hrefhttpsdocumenterjuliadocsorgstabledocumenterjl">Generation using <a href="https://documenter.juliadocs.org/stable/">Documenter.jl</a></a><li><a href="#local_preview_using_a_hrefhttpsgithubcomjuliadocsliveserverjlliveserverjl">Local preview using <a href="https://github.com/JuliaDocs/LiveServer.jl">LiveServer.jl</a></a></ol><li><a href="#running_things_on_github">Running things on github</a><li><a href="#providing_packages_to_others">Providing packages to others</a><ol><li><a href="#using_a_package_under_development">Using a package under development</a><li><a href="#registration_of_a_new_package_or_a_new_version_in_a_local_registry">Registration of a new package or a new version in a local registry</a><li><a href="#using_the_general_registry">Using the General registry</a></ol></ol></div> <h2 id=resources ><a href="#resources" class=header-anchor >Resources</a></h2> <ul> <li><p>Some other useful introductions to package authoring</p> <ul> <li><p>G. Dalle, J. Smit, A. Hill: <a href="https://modernjuliaworkflows.github.io/">Modern Julia Workflows</a> &#40;2024-09&#41;</p> <li><p>Jaan Tollander de Balsch: <a href="https://jaantollander.com/post/how-to-create-software-packages-with-julia-language/">How to Create Software Packages with Julia Language</a> &#40;2021-05&#41;</p> <li><p>Sören Dobberschütz: <a href="https://sdobber.github.io/juliapackage/">Tips and tricks to register your first Julia package</a> &#40;2021-10&#41;</p> <li><p>Kim Fung: <a href="https://medium.com/analytics-vidhya/an-introduction-to-continuous-integration-github-actions-for-julia-1a5a1a6e64d6">An Introduction to Continuous Integration &amp; GitHub Actions for Julia</a> &#40;2020-01&#41;</p> <li><p>Christopher Rackauckas: <a href="https://www.stochasticlifestyle.com/developing-julia-packages/">Developing Julia packages &#40;video&#41;</a> &#40;2019-10&#41;</p> </ul> <li><p><a href="https://pkgdocs.julialang.org/v1/glossary/#Glossary">Package manager glossary</a>. According to this, here, we assume that a <em>package</em> is Julia code which is supposed to be used by other projects, applications or packages.</p> </ul> <h2 id=starting_a_package ><a href="#starting_a_package" class=header-anchor >Starting a package</a></h2> <h3 id=where_do_packages_under_development_reside ><a href="#where_do_packages_under_development_reside" class=header-anchor >Where do packages under development reside ?</a></h3> <p>When developing Julia packages it is advisable to set the environment variable <a href="https://pkgdocs.julialang.org/v1/api/#Pkg.develop"><code>JULIA_PKG_DEVDIR</code></a> to a path convenient for you. By default &#40;if <a href="https://docs.julialang.org/en/v1/manual/environment-variables/#JULIA_DEPOT_PATH"><code>JULIA_DEPOT_PATH</code></a> was not changed&#41; it is <code>.julia/dev</code>. Julia packages checked out for development via <code>Pkg.develop&#40;&#41;</code> will reside there, and it is convenient to have all packages under development in this path.</p> <h3 id=starting_a_package_repository ><a href="#starting_a_package_repository" class=header-anchor >Starting a package repository</a></h3> <p>The <a href="https://pkgdocs.julialang.org/v1/creating-packages/">creating packges</a> chapter of the package manager documentation explains how to create a package with a minimal functional structure. Enabling important aspects of package workflow like continuous integration, documentation generation or git integration would involve the addition of all of this tooling by hand.</p> <p>The package <a href="https://github.com/JuliaCI/PkgTemplates.jl">PkgTemplates.jl</a> provides standard templates for creating Julia packages:</p> <pre><code class="julia hljs">$ cd $JULIA_PKG_DEVDIR
$ julia
julia&gt; <span class=hljs-keyword >using</span> PkgTemplates
julia&gt; t = Template(;
    user=<span class=hljs-string >&quot;UserName&quot;</span>,
    dir=<span class=hljs-string >&quot;.&quot;</span>,
    julia=<span class=hljs-string >v&quot;1.10&quot;</span>,
    plugins=[
    Git(; manifest=<span class=hljs-literal >false</span>, ssh=<span class=hljs-literal >true</span>),
    GitHubActions(),
    Codecov(),
    Documenter{GitHubActions}(),
    ],
    )

julia&gt; t(<span class=hljs-string >&quot;MyPkg&quot;</span>)</code></pre> <p>This creates a standard Julia package structure enhanced with tooling for CI, documentation, git etc., which is ready to be pushed to a corresponding github repository:</p> <pre><code class="julia hljs">MyPkg
├── .git
│  ...
├── .github
│  ├── dependabot.yml
│  └── workflows
│     ├── CI.yml
│     ├── CompatHelper.yml
│     └── TagBot.yml
├── .gitignore
├── docs
│  ├── make.jl
│  ├── Manifest.toml
│  ├── Project.toml
│  └── src
│     └── index.md
├── LICENSE
├── Manifest.toml
├── Project.toml
├── README.md
├── src
│  └── MyPkg.jl
└── test
   └── runtests.jl</code></pre> <ul> <li><p><a href="https://pkgdocs.julialang.org/v1/toml-files/#Project.toml"><code>Project.toml</code></a>: description of dependencies. This also provides the package with its own environment during development. It contains the universally unique identifier &#40;UUID&#41; used to identify the package and its name, author and version number.</p> <li><p><code>README.md</code>: Short information about the package. This will occur on the landing page of the github repository</p> <li><p><code>LICENSE</code>: License information. Should be one of the <a href="https://opensource.org/licenses">OSI approved</a> open source license if the package shall be registered with the Julia General Registry</p> <li><p><code>src</code>: subdirectory containing code</p> <ul> <li><p><code>src/MyPkg.jl</code>: Julia source file which must contain a module <code>NewPackageName</code> where all package code resides. It may include further source code files.</p> </ul> <li><p><code>test</code>: subdirectory containing test code</p> <ul> <li><p><code>test/runtests.jl</code>: script for running tests</p> <li><p><code>test/Project.toml</code>: &#40;optional&#41; environment file containing test only dependencies</p> </ul> <li><p><code>docs</code>: subdirectory containing documentation</p> <ul> <li><p><code>docs/make.jl</code>: script for building documentation based on Documenter.jl</p> <li><p><code>docs/Project.toml</code>: environment file containing dependencies for documentation</p> </ul> <li><p><code>.github</code> Configuration files for Continuous Integration</p> <ul> <li><p><a href="https://discourse.julialang.org/t/psa-use-dependabot-to-update-github-actions-automatically/96001/2?u&#61;j-fu"><code>.github/dependabot.yml</code></a>: github action which triggers a pull request if a workflow file has a new version</p> <li><p><code>.github/workflows/CI.yml</code> Control file for running continuous integration tests on github</p> <li><p><code>.github/workflows/CompatHelper.yml</code> github action which triggers a pull request if a package dependency has a new breaking version</p> <li><p><code>.github/workflows/TagBot.yml</code> github action which automatically creates git tags for newly registered versions of <code>MyPkg</code>.</p> <li><p>A <a href="https://pkgdocs.julialang.org/v1/toml-files/#Manifest.toml"><code>Manifest.toml</code></a> file is created as soon as the package environment is instantiated. It contains the full metadata of all package dependencies. This file <em>should not be tracked by git</em>. Instead, the <code>Project.toml</code> shall contain a <code>&#91;compat&#93;</code> section which inform the package resolver about the compatibility with different versions of dependencies.</p> </ul> </ul> <h2 id=tests ><a href="#tests" class=header-anchor >Tests</a></h2> <p>See also the <a href="https://pkgdocs.julialang.org/v1/creating-packages/#Adding-tests-to-the-package">Pkg documentation</a>.</p> <p>The files in <code>test</code> provide the environment and the code to run tests of the functions implemented in the package. While it is hard to have 100&#37; test coverage of the package functionality, one should strive to achieve this goal. Besides of the obvious reasons of reproducibility, peer pressure etc., sufficient test coverage helps to keep a package author sane. Imagine the need to change something in the package three years after the last serious work on it...</p> <p>It is quite possible that tests have more dependencies than the package itself. Therefore Julia packages can have their own test environment in <code>test/Project.toml</code>. Alternatively, the test dependencies can be listed in an &quot;&#91;extras&#93;&quot; section of <code>MyPkg/Project.toml</code>. The <code>test/runtests.jl</code> file contains the code for the tests. All code called from the <a href="https://docs.julialang.org/en/v1/stdlib/Test/#Test.@test"><code>@test</code></a> macro is part of the test coverage. A simple file <code>runtests.jl</code> contains e.g.:</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Test

<span class=hljs-meta >@test</span> <span class=hljs-number >1</span>+<span class=hljs-number >1</span> == <span class=hljs-number >2</span></code></pre> <p>Tests code can be called in different ways. In the package root environment:</p> <pre><code class="julia hljs">julia&gt; Pkg.test()</code></pre>
<p>or from the <code>Pkg</code> prompt:</p>
<pre><code class="julia hljs">] test</code></pre>
<p>The seame test can be invoked also in any environment with the package added:</p>
<pre><code class="julia hljs">julia&gt; Pkg.test(<span class=hljs-string >&quot;MyPkg&quot;</span>)</code></pre>
<p>or</p>
<pre><code class="julia hljs">] test MyPkg</code></pre>
<h2 id=documentation ><a href="#documentation" class=header-anchor >Documentation</a></h2>
<h3 id=generation_using_a_hrefhttpsdocumenterjuliadocsorgstabledocumenterjl ><a href="#generation_using_a_hrefhttpsdocumenterjuliadocsorgstabledocumenterjl" class=header-anchor >Generation using <a href="https://documenter.juliadocs.org/stable/">Documenter.jl</a></a></h3>
<p>Documenter collects the docstrings of functions of a package and builds a documentation website. If <code>MyPkg</code> contains code with docstrings like</p>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    mult(x,y)

Calculates the product of `x` and `y`
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> mult(x,y)
    <span class=hljs-keyword >return</span> x*y
<span class=hljs-keyword >end</span></code></pre>
<p>In a documentation markdown file this can be referred to in a &quot;<a href="https://documenter.juliadocs.org/stable/man/syntax/#@docs-block">@docs block</a>&quot;.</p>
<p>Documentation is built using the script <code>docs/make.jl</code> which needs to be started in the environmet defined in <code>docs</code>:</p>
<pre><code class="julia hljs">$ julia --project=docs
julia&gt; include(<span class=hljs-string >&quot;docs/make.jl&quot;</span>)</code></pre>
<h3 id=local_preview_using_a_hrefhttpsgithubcomjuliadocsliveserverjlliveserverjl ><a href="#local_preview_using_a_hrefhttpsgithubcomjuliadocsliveserverjlliveserverjl" class=header-anchor >Local preview using <a href="https://github.com/JuliaDocs/LiveServer.jl">LiveServer.jl</a></a></h3>
<p>By default, locally built documentation is created in the <code>docs/build</code> subdirectory. Preview can be performed using a local webserver pointing to this directory.</p>
<p><a href="https://github.com/JuliaDocs/LiveServer.jl">LiveServer.jl</a> provides one:</p>
<pre><code class="julia hljs">julia&gt; <span class=hljs-keyword >using</span> LiveServer
julia&gt; serve(dir=<span class=hljs-string >&quot;docs/build&quot;</span>, port=<span class=hljs-number >8001</span>)</code></pre>
<p>This starts a web browser pointing to <code>http://localhost:8100</code>, allowing to navigate documentations locally.</p>
<h2 id=running_things_on_github ><a href="#running_things_on_github" class=header-anchor >Running things on github</a></h2>
<p>For public repositories, github provides unlimited access to <a href="https://docs.github.com/en/actions/writing-workflows/quickstart">Github actions</a>. This means that the scripts under <code>.github/workflows</code> are active and triggered at the events described therein. Among others, the <code>CI.yml</code> triggers running of tests and documentation at every push to the main branch.</p>
<p>The script tries to deploy the documentation to a separate branch which publishes the documentation under <code>https://github.io/UserName/MyPkg</code>. For this purpose, github actions need to authenticate theselves with the repository. For this purpose, a <code>DOCUMENTER_KEY</code> ssh key needs to be stored in the repository. The setup is described in the <a href="https://documenter.juliadocs.org/stable/lib/public/#DocumenterTools.genkeys">Documenter.jl documentation</a>.</p>
<p>Alternatively, this can be done for <a href="https://discourse.julialang.org/t/julia-and-gitlab-self-hosted-a-state-of-the-art/86685">gitlab</a> as well.</p>
<h2 id=providing_packages_to_others ><a href="#providing_packages_to_others" class=header-anchor >Providing packages to others</a></h2>
<h3 id=using_a_package_under_development ><a href="#using_a_package_under_development" class=header-anchor >Using a package under development</a></h3>
<p>While the package is unregistered you can add it to the environment of a project:</p>
<pre><code class="julia hljs">$ cd project_dir
$ julia --project=@.
pkg&gt; add git_url</code></pre>
<p>In this case, the version in the git repository on the server is used via a shallow clone &#40;clone without versioning information&#41; created in <code>&#36;HOME/.julia/packages</code>. If you use</p>
<pre><code class="julia hljs">pkg&gt; dev git_url</code></pre>
<p>instead, a full clone is created in <code>&#36;JULIA_PKG_DEVDIR</code> and used. If the corresponding subdirectory in <code>JULIA_PKG_DEVDIR</code> does not exist, it will be checked out from <code>git_url</code>. The same would happen with registered packages added by name.</p>
<h3 id=registration_of_a_new_package_or_a_new_version_in_a_local_registry ><a href="#registration_of_a_new_package_or_a_new_version_in_a_local_registry" class=header-anchor >Registration of a new package or a new version in a local registry</a></h3>
<p>A registry is a git repository containing package information which allows to find the package source code given the package name. By default, julia packages are found in the General registry, wich is also installed by default. However, it is possible to have multiple registries, and to maintain your own registry.</p>
<p>The <a href="https://github.com/GunnarFarneback/LocalRegistry.jl">LocalRegistry.jl</a> allows for an easy workflow.</p>
<p>We assume to speak about <code>MyRegistry</code> as an example, but generally this is true for all registries. Assuming write access to the repository containing <code>MyRegistry</code>, the process is the following:</p>
<p>Registring a new version of MyPkg goes as simple as follows:</p>
<pre><code class="julia hljs">MyPkg$ julia --project
julia&gt; <span class=hljs-keyword >using</span> MyPkg
julia&gt; <span class=hljs-keyword >using</span> LocalRegistry
julia&gt; LocalRegistry.register(X,<span class=hljs-string >&quot;MyRegistry&quot;</span>, push=<span class=hljs-literal >true</span>)</code></pre>
<p>After this, do not forget to create a tag in your repository marking the version <code>x.y.z</code> of the package:</p>
<pre><code class="julia hljs">$ git tag vx.y.z</code></pre>
<p>If users want to access <code>MyPkg</code> via this registry, they first need to add the registry to their julia installation:</p>
<pre><code class="julia hljs">julia&gt; Pkg.Registry.add(<span class=hljs-string >&quot;https://github.com/UserName/MyRegistry&quot;</span>)</code></pre>
<p>After that, they can add the package as usual:</p>
<pre><code class="julia hljs">julia&gt; Pkg.add(<span class=hljs-string >&quot;MyPackage&quot;</span>)</code></pre>
<h3 id=using_the_general_registry ><a href="#using_the_general_registry" class=header-anchor >Using the General registry</a></h3>
<p>Registering and updating packages in the general registry is automatically handeled by the <a href="https://github.com/JuliaRegistries/Registrator.jl">JuliaRegistrator</a> github app.</p>
<p>It assumes compliance to a number of <a href="https://juliaregistries.github.io/RegistryCI.jl/stable/guidelines/">heuristic rules</a> concerning package names, Project.toml content etc.</p>
<p>If these are followed, just comment the most recent commit of your package with</p>
<pre><code class="julia hljs"><span class=hljs-meta >@JuliaRegistrator</span> register</code></pre>
<p>and the process starts. JuliaRegistrator checks compliance to the rules, and finally merges the updated information into the General registry</p>
<ul>
<li><p>after 3 days for a new package</p>

<li><p>after <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo></mrow><annotation encoding="application/x-tex">\approx</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.48312em;vertical-align:0em;"></span><span class=mrel >≈</span></span></span></span> 20 min for a new version</p>

</ul>

<div class=img-small >
<img src="https://raw.githubusercontent.com/JuliaRegistries/Registrator.jl/master/graphics/logo.png">
</div>

<p>It needs to be installed as a github app in for the package repository.</p>
<p>
<hr size=5  noshade>
 <strong>Update history</strong></p>
<ul>
<li><p>2024-10-23: Fundamental update</p>

<li><p>2023-04-24: Draft updated &#43; made public</p>

<li><p>2022-12-06: First draft</p>

</ul>
<div class=page-foot >
  <div class=copyright >
    &copy; Jürgen Fuhrmann. License: <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"> CC-BY-SA 4.0</a>. Last modified: March 26, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
Upon finding factual errors, typos etc. <a href=https://github.com/j-fu/marginalia/issues> raise an issue<a>.
<center>  <a href="/marginalia/feed.xml"> <img src="/marginalia/assets/rss.png" style="width:100px;"></a> </center>
  </div>
</div>


</div>
      </div>  
    </div> 
    
        



    
    
        


    
    <label for=sidebar-checkbox  class=sidebar-toggle ></label>