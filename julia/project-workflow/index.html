<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/marginalia/libs/highlight/github.min.css"> <link rel=stylesheet  href="/marginalia/css/franklin.css"> <link rel=stylesheet  href="/marginalia/css/poole_lanyon.css"> <link rel=stylesheet  href="/marginalia/css/adjust.css"> <link rel=icon  href="/marginalia/assets/favicon.png"> <title>Julia: Project Workflow Recommendations</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>Marginalia</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/marginalia/">Home</a> <a class="sidebar-nav-item " href="/marginalia/julia/">Julia</a> <a class="sidebar-nav-item " href="/marginalia/git/">Git</a> <a class="sidebar-nav-item " href="/marginalia/older-posts/">Older posts</a> </nav> <div class=sidebar-item > <p>&copy; Jürgen Fuhrmann.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/marginalia/" title=Home >Marginalia</a> </h3> </div> </div> </div> <div class="container content"> <div class=franklin-content ><h1 id=julia_project_workflow_recommendations ><a href="#julia_project_workflow_recommendations" class=header-anchor >Julia: Project Workflow Recommendations</a></h1> <p><div class=franklin-toc ><ol><li><a href="#rationale">Rationale</a><li><a href="#recommendations">Recommendations</a><ol><li><a href="#generate_the_project_directory_itself_as_a_package">Generate the project directory itself as a package</a><li><a href="#manifest_or_not">Manifest or not ?</a><li><a href="#always_start_julia_from_the_package_root">Always start Julia from the package root</a><li><a href="#activate_the_project_environment_in_notebooks_and_scripts">Activate the project environment in notebooks and scripts</a><li><a href="#consider_using_drwatsonjl">Consider using DrWatson.jl</a><li><a href="#a_sample_project_tree">A sample project tree</a><li><a href="#new_packages_can_evolve_from_the_project_code">New packages can evolve from the project code</a></ol><li><a href="#summary">Summary</a></ol></div> </p> <p>The term &quot;project&quot; in this post corresponds to the term &quot;application&quot; in <a href="https://pkgdocs.julialang.org/v1/glossary/#Glossary">package manager glossary</a></p> <h2 id=rationale ><a href="#rationale" class=header-anchor >Rationale</a></h2> <p>Some ideas on basic julia workflow are given <a href="/marginalia/julia/basic-workflow">here</a>. For a larger project, structuring of the project code is essential for many reasons, some of them are:</p> <ul> <li><p>Different project scripts and Pluto notebooks may share some parts of the code, and you want to avoid <a href="https://en.wikipedia.org/wiki/Don&#37;27t_repeat_yourself">repeating yourself</a>.</p> <li><p>Modularization of the project code should facilitate maintainability and extendability.</p> <li><p>May be some of the code slowly turns into a package.</p> <li><p>You want to have unit testing available in the project.</p> <li><p>The whole project directory <em>still</em> shall be shareable with collaborators in a reproducible way.</p> </ul> <p>Morevover, it is important to prevent package compatibility clashes between different projects. Therefore, perhaps, the most important feature of the approach described consists in the idea that each project has its own package environment, as described in <a href="/marginalia/julia/basic-workflow/#record_project_dependencies_in_reproducible_environments">&quot;Basic Workflow&quot;</a>.</p> <h2 id=recommendations ><a href="#recommendations" class=header-anchor >Recommendations</a></h2> <p>The following recommendations are partially inspired by B. Kaminski&#39;s post on <a href="https://bkamins.github.io/julialang/2020/05/18/project-workflow.html">project workflow</a> and the <a href="https://github.com/JuliaDynamics/DrWatson.jl">DrWatson.jl</a> package by G. Datseris.</p> <h3 id=generate_the_project_directory_itself_as_a_package ><a href="#generate_the_project_directory_itself_as_a_package" class=header-anchor >Generate the project directory itself as a package</a></h3> <p>Name this e.g. <code>MyProject</code>. Use<a href="https://pkgdocs.julialang.org/v1/creating-packages/"><code>Pkg.generate</code></a> or <a href="https://github.com/invenia/PkgTemplates.jl">PkgTemplates.jl</a>. Unlike a published Julia package, this <em>project-package</em> will remain not be registered in a Julia package registry, its code will be shared directly via git repository urls. Developing the project in such a project-package has the following advantages:</p> <ul> <li><p>Straightforward way to share the code in the <code>src</code> folder among different project scripts and notebooks based on one shared environment via <code>using MyProject</code>.</p> <li><p>Straightforward availability of Julia&#39;s test and documentation functionality for the project.</p> <li><p>Reproducibility due to dependencies recorded in the project environment &#40;files <code>Project.toml</code> and <code>Manifest.toml</code>&#41;.</p> </ul> <h3 id=manifest_or_not ><a href="#manifest_or_not" class=header-anchor >Manifest or not ?</a></h3> <p>Should the <code>Manifest.toml</code> be checked into the project repository or not ? The answer is - your mileage may vary.</p> <p>Pro Checking in the manifest file:</p> <ul> <li><p>Strong reproducibility of the computational results</p> <li><p>Starting with Julia 1.11, there can be different Manifest files for each Julia minor version &#40;e.g. <code>Manifest-v1.11.toml</code>&#41;, checking in the respective manifests can allow to use different Julia versions.</p> <li><p>Subpackages in relative paths can only be found via the <code>Manifest.toml</code> &#40;for Julia &lt;1.11&#41;</p> </ul> <p>Pro not checking in the manifest file:</p> <ul> <li><p>Strong reproducibility is required when publishing results, not during development, where experimentation is ubiquitous</p> <li><p>Dependency version checking can be managed via the <code>&#91;compat&#93;</code> section in <code>Project.toml</code></p> <li><p>With Julia &lt;1.11, checking in the manifest file requires that all project collaborators use the same Julia version</p> <li><p>Subpackages in relative paths can be found via the <code>&#91;sources&#93;</code> section of Project.toml &#40;for Julia &gt;&#61;1.11&#41;</p> <li><p>Successful tests with different dependency versions are a sign of robustness of the package code. Diverging results with different Julia versions or different versions of dependencies hint on possible problems of the project code or the packages.</p> <li><p>Easy unit tests on different Julia versions</p> </ul> <h3 id=always_start_julia_from_the_package_root ><a href="#always_start_julia_from_the_package_root" class=header-anchor >Always start Julia from the package root</a></h3> <ul> <li><p>When working with the project, always run julia from the package root with the package environment activated: <code>julia --project&#61;.</code> </p> </ul> <h3 id=activate_the_project_environment_in_notebooks_and_scripts ><a href="#activate_the_project_environment_in_notebooks_and_scripts" class=header-anchor >Activate the project environment in notebooks and scripts</a></h3> <p>Project specific scripts and Pluto notebooks would reside in a subdirectory and call <code>Pkg.activate&#40;joinpath&#40;@__DIR__,&quot;..&quot;&#41;&#41;</code> to activate the <code>MyProject</code> environment. As a consequence, in the notebooks Pluto&#39;s in-built package manager will be disabled and the project specific notebooks will share the <code>MyProject</code> environment and <em>cannot be shared independent from the <code>MyProject</code> tree</em> &#40;If independent sharing is desired, common project code can be collected into a package residing in <code>packages</code> and registered in a registry; registering <code>MyProject</code> itself as a package is not recommended. – More about this in another post&#41;.</p> <h3 id=consider_using_drwatsonjl ><a href="#consider_using_drwatsonjl" class=header-anchor >Consider using DrWatson.jl</a></h3> <p>You may use <a href="https://github.com/JuliaDynamics/DrWatson.jl">DrWatson.jl</a> for managing subdirectory access, simulation results and version tagging. By explicitely activating the project environment at the start of Julia or in the notebook Pkg cell, you can avoid <code>@quickactivate</code> and avoid putting <code>using DrWatson</code> into script files and notebooks for the sole purpose of activating the common environment. See also <a href="https://github.com/JuliaDynamics/DrWatson.jl/issues/261">this discussion</a>.</p> <h3 id=a_sample_project_tree ><a href="#a_sample_project_tree" class=header-anchor >A sample project tree</a></h3> <p>A sample project tree could e.g. look like this</p> <pre><code class="julia hljs">MyProject/
├── src
│   └── MyProject.jl
├── docs
│   ├── make.jl
│   ├── Project.toml
│   └── src
│       └── index.md
├── LICENSE
├── notebooks
│   └── demo-notebook.jl
├── Project.toml
├── README.md
├── scripts
│   └── demo-script.jl
├── papers
├── etc
│   ├── runpluto.jl
│   └── instantiate.jl
└── test
    └── runtests.jl</code></pre> <p>The essential role of these files is as follows:</p> <ul> <li><p><code>Project.toml</code>: The project file describes the project on a high level. It lists packages used by the prokject together with version compatibility constraints <a href="https://pkgdocs.julialang.org/v1/toml-files/#Project-and-Manifest">&#40;see documentation&#41;</a></p> <li><p><code>LICENSE</code>: License of the project. By default it is the MIT license</p> <li><p><code>README.md</code>: This file</p> <li><p><code>src</code>: Subdirectory for project specific code as part of the MyProject package representing the project.</p> <li><p><code>test</code>: Unit tests for project code in <code>src</code>. Could include something from <code>scripts</code>, <code>notebooks</code>.</p> <li><p><code>scripts</code>, <code>notebooks</code>: &quot;Frontend&quot; code for creating project results</p> <li><p><code>papers</code>: &quot;Wer schreibt, der bleibt&quot; - besides of coding, you probably should publish your results...</p> <li><p><code>docs</code>: Sources for the documentation created with <code>Documenter.jl</code></p> <li><p><code>etc</code>: Service code</p> </ul> <p>Using <a href="https://github.com/tpapp/PkgSkeleton.jl">PkgSkeleton.jl</a>, you can generate these files: Download and unpack the corresponding project skeleton <a href="/marginalia/assets/project-skeleton.zip">project-skeleton.zip</a>. Then invoke</p> <pre><code class="julia hljs">julia&gt; <span class=hljs-keyword >using</span> PkgSkeleton
julia&gt; PkgSkeleton.generate(<span class=hljs-string >&quot;MyProject&quot;</span>; templates=[<span class=hljs-string >&quot;project-skeleton&quot;</span>])</code></pre> <p>Feel free to adapt the generated directory tree to your needs and don&#39;t forget to make a git repository out of it as early as possible.</p> <h3 id=new_packages_can_evolve_from_the_project_code ><a href="#new_packages_can_evolve_from_the_project_code" class=header-anchor >New packages can evolve from the project code</a></h3> <p>For this purpose, optionally you can have a folder <code>packages</code> which contains other sub-packages which potentially can evolve into standalone, even registered packages. As <a href="https://github.com/JuliaLang/Pkg.jl/issues/1214">relative paths are recorded in Manifest.toml</a>, these are made available within the project via <code>Pkg.develop&#40;path&#61;&quot;packages/MySubPackage&quot;&#41;</code>. Starting wit Julia 1.11, <code>Project.toml</code> can have a <a href="https://pkgdocs.julialang.org/dev/toml-files/#The-&#91;sources&#93;-section"><code>&#91;sources&#93;</code> section</a> which can contain a relative path for a subpackage. Either way, using this approach, the whole project tree including sub-packages will stay relocateable.</p> <ul> <li><p>This allows for easy start of low key package development. At a later stage, <code>MySubPackage</code> could be registered as a Julia package while still residing in the project tree, or even removed from the project tree without affecting scripts depending on it – once registered, the package can be added to the project environment via <code>Pkg.add</code> instead of <code>Pkg.develop</code>, or just removed from the <code>&#91;sources&#93;</code> section.</p> </ul> <h2 id=summary ><a href="#summary" class=header-anchor >Summary</a></h2> <ul> <li><p>Script functionality should be developed in functions, avoiding global variables</p> <li><p>Create a project specific environment as a project-package</p> <li><p>Use the REPL and Revise.jl, start julia in the activated project environment</p> <li><p>Place shared code among project specific scripts or notebooks either in the <code>src</code> subdirectory as part of the project-package, or in a sub-package in a subdirectory of the project-package</p> <li><p>Separate namespaces of scripts by using modules</p> <li><p>Activate the shared project environment of the project-package in project specific Pluto notebooks. </p> <li><p>Write tests and examples</p> </ul> <p>By taking advantage of Julia&#39;s best-in-class package management facilities, the proposed approach goes a long way in the direction of maintaining sustainable research software. From a <a href="https://de.slideshare.net/andreas.zeller/sustainable-research-software">talk by A. Zeller</a>:</p> <ol> <li><p>Have a repo ✓</p> <li><p>Anyone can build ✓</p> <li><p>Have tests ✓</p> <li><p>Be open for extensions ✓</p> <li><p>Have examples ✓</p> </ol> <p> <hr size=5  noshade> <strong>Update history</strong></p> <ul> <li><p>2025-03-29: Switch ot PkgSkeleton for the template</p> <li><p>2024-07-31: Julia 1.11</p> <li><p>2023-04-24: Intermediate headers</p> <li><p>2022-02-09: RSS</p> <li><p>2021-12-02: The term &quot;project&quot; in this post corresponds to the term &quot;application&quot; in <a href="https://pkgdocs.julialang.org/v1/glossary/#Glossary">package manager glossary</a>.</p> <li><p>2021-11-15: Initial version </p> </ul> <div class=page-foot > <div class=copyright > &copy; Jürgen Fuhrmann. License: <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"> CC-BY-SA 4.0</a>. Last modified: March 27, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. Upon finding factual errors, typos etc. <a href=https://github.com/j-fu/marginalia/issues> raise an issue<a>. <center> <a href="/marginalia/feed.xml"> <img src="/marginalia/assets/rss.png" style="width:100px;"></a> </center> </div> </div> </div> </div> </div> <label for=sidebar-checkbox  class=sidebar-toggle ></label>